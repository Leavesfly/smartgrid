# æ™ºèƒ½ç”µç½‘éœ€æ±‚å“åº”ç®¡ç†ç³»ç»Ÿ

[![Java](https://img.shields.io/badge/Java-8+-blue.svg)](https://www.oracle.com/java/)
[![Maven](https://img.shields.io/badge/Maven-3.6+-green.svg)](https://maven.apache.org/)
[![License](https://img.shields.io/badge/License-MIT-yellow.svg)](LICENSE)

## ğŸ“– é¡¹ç›®æ¦‚è¿°

æ™ºèƒ½ç”µç½‘éœ€æ±‚å“åº”ç®¡ç†ç³»ç»Ÿæ˜¯ä¸€ä¸ªåŸºäºæ¨¡æ‹Ÿé€€ç«ç®—æ³•ï¼ˆSAPCï¼‰çš„ç”µåŠ›ä»·æ ¼ä¼˜åŒ–ç³»ç»Ÿã€‚è¯¥ç³»ç»Ÿé€šè¿‡åŠ¨æ€å®šä»·æœºåˆ¶å’Œç”¨æˆ·éœ€æ±‚å“åº”ï¼Œå®ç°ç”µç½‘è´Ÿè½½å‡è¡¡å’Œé›¶å”®å•†åˆ©æ¶¦æœ€å¤§åŒ–çš„åŒé‡ç›®æ ‡ã€‚

### âœ¨ æ ¸å¿ƒç‰¹æ€§

- ğŸ”„ **åŠ¨æ€å®šä»·æœºåˆ¶**ï¼šåŸºäºæ¨¡æ‹Ÿé€€ç«ç®—æ³•çš„å®æ—¶ç”µä»·ä¼˜åŒ–
- ğŸ“Š **éœ€æ±‚å“åº”ç®¡ç†**ï¼šæ™ºèƒ½ç”¨æˆ·ç”¨ç”µè¡Œä¸ºåˆ†æå’Œå¼•å¯¼
- ğŸš€ **å¤šçº¿ç¨‹æ¶æ„**ï¼šé«˜å¹¶å‘å¤„ç†ç”¨æˆ·è¯·æ±‚å’Œä»·æ ¼è®¡ç®—
- ğŸ“ˆ **åˆ©æ¶¦ä¼˜åŒ–ç®—æ³•**ï¼šé›¶å”®å•†æ”¶ç›Šæœ€å¤§åŒ–ç­–ç•¥
- ğŸ” **å®æ—¶ç›‘æ§ç³»ç»Ÿ**ï¼šå…¨æ–¹ä½çš„ç³»ç»ŸçŠ¶æ€ç›‘æ§å’Œæ—¥å¿—è®°å½•
- âš–ï¸ **è´Ÿè½½å‡è¡¡**ï¼šç”µç½‘å³°è°·ç”¨ç”µå¹³è¡¡ä¼˜åŒ–

## ğŸ—ï¸ ç³»ç»Ÿæ¶æ„

ç³»ç»Ÿé‡‡ç”¨å®¢æˆ·ç«¯-æœåŠ¡å™¨æ¶æ„ï¼Œåˆ†ä¸ºé›¶å”®å•†æ¨¡å—å’Œç”¨æˆ·æ¨¡å—ä¸¤å¤§æ ¸å¿ƒéƒ¨åˆ†ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    æ™ºèƒ½ç”µç½‘ç®¡ç†ç³»ç»Ÿ                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚    é›¶å”®å•†æ¨¡å—        â”‚              ç”¨æˆ·æ¨¡å—                â”‚
â”‚                     â”‚                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚RetailerServerâ”‚â—„â”€â”€â”€â”¼â”€â”€â”€â–ºâ”‚UserThread   â”‚ â”‚UserThread   â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚         â”‚           â”‚            â”‚              â”‚          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ Retailer    â”‚    â”‚    â”‚    Users    â”‚ â”‚    Users    â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚         â”‚           â”‚                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚                                       â”‚
â”‚  â”‚SAPC_Algorithmâ”‚   â”‚                                       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ğŸ”§ æ ¸å¿ƒç»„ä»¶

#### é›¶å”®å•†æ¨¡å—
- **RetailerServer**: æœåŠ¡å™¨ç«¯ä¸»æ§åˆ¶å™¨ï¼Œç®¡ç†å®¢æˆ·ç«¯è¿æ¥
- **Retailer**: é›¶å”®å•†æ ¸å¿ƒä¸šåŠ¡é€»è¾‘å¤„ç†
- **SAPC_Algorithm**: æ¨¡æ‹Ÿé€€ç«ä»·æ ¼æ§åˆ¶ç®—æ³•å®ç°
- **RetailerProfitCalculator**: åˆ©æ¶¦è®¡ç®—å’Œä¼˜åŒ–å¼•æ“

#### ç”¨æˆ·æ¨¡å—
- **Users**: ç”¨æˆ·å®ä½“å’Œç”¨ç”µè¡Œä¸ºæ¨¡æ‹Ÿ
- **UserThread**: ç”¨æˆ·ç«¯é€šä¿¡çº¿ç¨‹å¤„ç†
- **UserConsumptionVector**: ç”¨æˆ·ç”¨ç”µå‘é‡æ¨¡å‹
- **UserMaxSatisfaConsumVector**: ç”¨æˆ·æ»¡æ„åº¦æœ€å¤§åŒ–æ¨¡å‹

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ğŸ“‹ ç¯å¢ƒè¦æ±‚

- **Java**: 8 æˆ–æ›´é«˜ç‰ˆæœ¬
- **Maven**: 3.6 æˆ–æ›´é«˜ç‰ˆæœ¬
- **æ“ä½œç³»ç»Ÿ**: Windows / macOS / Linux

### ğŸ› ï¸ å®‰è£…æ­¥éª¤

1. **å…‹éš†é¡¹ç›®**
```bash
git clone https://github.com/your-repo/smartgrid.git
cd smartgrid
```

2. **ç¼–è¯‘é¡¹ç›®**
```bash
mvn clean compile
```

3. **è¿è¡Œæµ‹è¯•**
```bash
mvn test
```

4. **æ‰“åŒ…é¡¹ç›®**
```bash
mvn clean package
```

### â–¶ï¸ è¿è¡Œç¤ºä¾‹

#### å¯åŠ¨å®Œæ•´æ¼”ç¤ºç¨‹åº
```bash
java -cp target/classes io.leavesfly.smartgrid.example.SmartGridRefactoredDemo
```

#### åˆ†åˆ«å¯åŠ¨é›¶å”®å•†å’Œç”¨æˆ·
```bash
# å¯åŠ¨é›¶å”®å•†æœåŠ¡å™¨
java -cp target/classes io.leavesfly.smartgrid.retailer.RetailerServer

# å¯åŠ¨ç”¨æˆ·å®¢æˆ·ç«¯ï¼ˆå¦å¼€ç»ˆç«¯ï¼‰
java -cp target/classes io.leavesfly.smartgrid.user.Users
```

## ğŸ“Š æ ¸å¿ƒç®—æ³•

### ğŸŒ¡ï¸ æ¨¡æ‹Ÿé€€ç«ç®—æ³•ï¼ˆSAPCï¼‰

ç³»ç»Ÿé‡‡ç”¨æ¨¡æ‹Ÿé€€ç«ç®—æ³•è¿›è¡Œç”µä»·ä¼˜åŒ–ï¼Œé€šè¿‡ä»¥ä¸‹æ­¥éª¤å®ç°ï¼š

```
1. åˆå§‹åŒ– â†’ 2. ç”Ÿæˆæ–°è§£ â†’ 3. è®¡ç®—ç›®æ ‡å‡½æ•° â†’ 4. Metropoliså‡†åˆ™åˆ¤æ–­ â†’ 5. æ›´æ–°å½“å‰è§£ â†’ 6. é™æ¸© â†’ å›åˆ°æ­¥éª¤2
```

**ç®—æ³•å‚æ•°é…ç½®ï¼š**
- åˆå§‹æ¸©åº¦ï¼š`T = e^(-1) â‰ˆ 0.368`
- ç»ˆæ­¢æ¸©åº¦ï¼š`E = e^(-5) â‰ˆ 0.007`
- é™æ¸©ç­–ç•¥ï¼š`T = T / ln(k)`

### ğŸ’° åˆ©æ¶¦è®¡ç®—æ¨¡å‹

é›¶å”®å•†åˆ©æ¶¦è®¡ç®—é‡‡ç”¨äºŒæ¬¡å‡½æ•°æ¨¡å‹ï¼š

```
Profit = Î£(price[i] Ã— consumption[i] - cost_function(consumption[i]))
```

å…¶ä¸­æˆæœ¬å‡½æ•°è€ƒè™‘äº†è´­ç”µæˆæœ¬å’Œç³»ç»Ÿè¿è¥æˆæœ¬ã€‚

## âš™ï¸ é…ç½®è¯´æ˜

### é›¶å”®å•†é…ç½®å‚æ•°

| å‚æ•° | ç±»å‹ | é»˜è®¤å€¼ | è¯´æ˜ |
|------|------|--------|------|
| `timeSlots` | int | 4 | æ—¶æ®µæ•°é‡ |
| `ListenPort` | int | 1234 | æœåŠ¡ç›‘å¬ç«¯å£ |
| `T` | float | eâ»Â¹ | æ¨¡æ‹Ÿé€€ç«åˆå§‹æ¸©åº¦ |
| `E` | float | eâ»âµ | æ¨¡æ‹Ÿé€€ç«ç»ˆæ­¢æ¸©åº¦ |
| `a` | float | 0.005 | åˆ©æ¶¦è®¡ç®—äºŒæ¬¡é¡¹ç³»æ•° |
| `b` | float | 0.001 | åˆ©æ¶¦è®¡ç®—ä¸‰æ¬¡é¡¹ç³»æ•° |

### ç”¨æˆ·é…ç½®å‚æ•°

| å‚æ•° | ç±»å‹ | é»˜è®¤å€¼ | è¯´æ˜ |
|------|------|--------|------|
| `userNum` | int | 2 | ç”¨æˆ·æ•°é‡ |
| `ip` | String | 127.0.0.1 | æœåŠ¡å™¨IPåœ°å€ |
| `port` | int | 1234 | æœåŠ¡å™¨ç«¯å£ |
| `A_applianceNum` | int | 4 | Aç±»ç”µå™¨æ•°é‡ï¼ˆä¸å¯è°ƒèŠ‚ï¼‰ |
| `B_applianceNum` | int | 4 | Bç±»ç”µå™¨æ•°é‡ï¼ˆå¯è°ƒèŠ‚ï¼‰ |

## ğŸ§ª æµ‹è¯•

### è¿è¡Œæ‰€æœ‰æµ‹è¯•
```bash
mvn test
```

### è¿è¡Œç‰¹å®šæµ‹è¯•ç±»
```bash
mvn test -Dtest=RetailerProfitCalculatorTest
```

### æŸ¥çœ‹æµ‹è¯•è¦†ç›–ç‡
```bash
mvn test jacoco:report
```

æµ‹è¯•æŠ¥å‘Šå°†ç”Ÿæˆåœ¨ `target/site/jacoco/index.html`

## ğŸ“ å¼€å‘æŒ‡å—

### ä»£ç ç»“æ„

```
src/
â”œâ”€â”€ main/java/io/leavesfly/smartgrid/
â”‚   â”œâ”€â”€ core/                    # æ ¸å¿ƒç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ algorithm/           # ç®—æ³•å®ç°
â”‚   â”‚   â”œâ”€â”€ config/             # é…ç½®ç®¡ç†
â”‚   â”‚   â””â”€â”€ model/              # æ•°æ®æ¨¡å‹
â”‚   â”œâ”€â”€ retailer/               # é›¶å”®å•†æ¨¡å—
â”‚   â”œâ”€â”€ user/                   # ç”¨æˆ·æ¨¡å—
â”‚   â”œâ”€â”€ util/                   # å·¥å…·ç±»
â”‚   â””â”€â”€ example/                # ç¤ºä¾‹ç¨‹åº
â””â”€â”€ test/                       # æµ‹è¯•ä»£ç 
```

### ç¼–ç è§„èŒƒ

- ä½¿ç”¨ä¸­æ–‡æ³¨é‡Šè¯´æ˜æ ¸å¿ƒé€»è¾‘
- éµå¾ª Java å‘½åè§„èŒƒ
- å•å…ƒæµ‹è¯•è¦†ç›–ç‡ä¸ä½äº 80%
- é‡è¦æ–¹æ³•å¿…é¡»åŒ…å« JavaDoc æ–‡æ¡£

### æäº¤ä»£ç 

1. ç¡®ä¿æ‰€æœ‰æµ‹è¯•é€šè¿‡
2. æ›´æ–°ç›¸å…³æ–‡æ¡£
3. éµå¾ª Git æäº¤ä¿¡æ¯è§„èŒƒ
4. åˆ›å»º Pull Request

## ğŸ“ˆ æ€§èƒ½ä¼˜åŒ–

### ç³»ç»Ÿæ€§èƒ½æŒ‡æ ‡

- **å¹¶å‘ç”¨æˆ·æ”¯æŒ**: 100+ ç”¨æˆ·åŒæ—¶åœ¨çº¿
- **ç®—æ³•æ”¶æ•›æ—¶é—´**: < 10ç§’ï¼ˆ4æ—¶æ®µï¼Œ2ç”¨æˆ·ï¼‰
- **å†…å­˜ä½¿ç”¨**: < 256MB
- **CPUä½¿ç”¨ç‡**: < 30%

### ä¼˜åŒ–å»ºè®®

1. **ç®—æ³•ä¼˜åŒ–**: è°ƒæ•´åˆå§‹æ¸©åº¦å’Œé™æ¸©ç­–ç•¥
2. **ç½‘ç»œä¼˜åŒ–**: ä½¿ç”¨è¿æ¥æ± ç®¡ç†å®¢æˆ·ç«¯è¿æ¥
3. **å†…å­˜ä¼˜åŒ–**: åˆç†è®¾ç½®JVMå †å¤§å°
4. **æ—¥å¿—ä¼˜åŒ–**: é…ç½®å¼‚æ­¥æ—¥å¿—å†™å…¥

## ğŸ“š æ–‡æ¡£èµ„æº

- [ç³»ç»Ÿæ¶æ„è®¾è®¡](docs/architecture.md)
- [ç®—æ³•è¯¦ç»†è¯´æ˜](docs/algorithm.md)
- [APIæ–‡æ¡£](docs/api.md)
- [éƒ¨ç½²æŒ‡å—](docs/deployment.md)
- [å¸¸è§é—®é¢˜](docs/faq.md)

## ğŸ¤ è´¡çŒ®æŒ‡å—

æ¬¢è¿è´¡çŒ®ä»£ç ï¼è¯·éµå¾ªä»¥ä¸‹æ­¥éª¤ï¼š

1. Fork é¡¹ç›®
2. åˆ›å»ºç‰¹æ€§åˆ†æ”¯ (`git checkout -b feature/AmazingFeature`)
3. æäº¤æ›´æ”¹ (`git commit -m 'Add some AmazingFeature'`)
4. æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/AmazingFeature`)
5. åˆ›å»º Pull Request

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®åŸºäº MIT è®¸å¯è¯ - æŸ¥çœ‹ [LICENSE](LICENSE) æ–‡ä»¶äº†è§£è¯¦æƒ…ã€‚

## ğŸ‘¥ ä½œè€…

- **å±±æ³½** - *é¡¹ç›®ç»´æŠ¤è€…* 

## ğŸ™ è‡´è°¢

æ„Ÿè°¢æ‰€æœ‰ä¸ºè¿™ä¸ªé¡¹ç›®åšå‡ºè´¡çŒ®çš„å¼€å‘è€…å’Œç ”ç©¶äººå‘˜ã€‚

## ğŸ“ è”ç³»æˆ‘ä»¬

å¦‚æœ‰é—®é¢˜æˆ–å»ºè®®ï¼Œè¯·é€šè¿‡ä»¥ä¸‹æ–¹å¼è”ç³»ï¼š

- ğŸ“§ é‚®ç®±: [your-email@example.com]
- ğŸ› é—®é¢˜åé¦ˆ: [GitHub Issues](https://github.com/your-repo/smartgrid/issues)
- ğŸ’¬ è®¨è®ºåŒº: [GitHub Discussions](https://github.com/your-repo/smartgrid/discussions)

---

â­ å¦‚æœè¿™ä¸ªé¡¹ç›®å¯¹ä½ æœ‰å¸®åŠ©ï¼Œè¯·ç»™æˆ‘ä»¬ä¸€ä¸ª Starï¼